manifest {
    mainScript = 'main.nf'
}

docker.enabled = true

// default parameters
params {
    max_cores = Runtime.runtime.availableProcessors()
    cores = "5"
    memory = 8.GB

    profile = false
    help = false

    // input
    reads = ''
    species = ''
    genome = ''
    annotation = ''
    dge = ''
    index = ''
  
    // parameters
    strand = '0'
    mode = 'single'
    tpm = 1
    fastp_additional_params = '-5 -3 -W 4 -M 20 -l 15 -x -n 5 -z 6'
    histat2_additional_params = ''

    busco = 'euarchontoglires_odb9'
    full = ''

    skip_sortmerna = false
    assembly = ''
  
    // folder structure
    output = 'results'
    fastp_dir = '01-Trimming/fastp'
    sortmerna_dir = '02-Sortmerna'
    hisat2_dir = '03-Mapping/hisat2'
    featurecounts_dir = '04-Counting/featurecounts'
    tpm_filter_dir = '05-CountingFilter/TPM'
    annotation_dir = '06-Annotation'
    deseq2_dir = '07-DifferentialExpression/deseq2'
    assembly_dir = '08-Assembly/de_novo'
    rnaseq_annotation_dir = '09-RNA-Seq_Annotation/'
    // if the UniRef90 option for dammit is activated via --uniref90, this parameter will be set to 'uniref90' for the dammit output 
    uniref90_dir = '' 
    multiqc_dir = 'Summary'

    // location for autodownload data like databases
    permanentCacheDir = 'nextflow-autodownload-databases'
    // location for storing the conda environments
    condaCacheDir = 'conda'

    // optional profile configurations, mainly necessary for HPC executions
    workdir = "/tmp/nextflow-work-$USER"

    cloudProcess = false
}

profiles {
    
    // executors
    local {
        params.cloudProcess = false
        includeConfig 'configs/local.config'
    }

    slurm {
        params.cloudProcess = true
        includeConfig 'configs/slurm.config' }

    // engines 
    conda {
        conda.cacheDir = params.condaCacheDir
        includeConfig 'configs/conda.config'
    }

    // predefined combinations
    // local execution with conda
    standard {
        conda.cacheDir = params.condaCacheDir
        includeConfig 'configs/local.config'
        includeConfig 'configs/conda.config' 
    }
    // ARA specific profile
    ara {
        params.cloudProcess = true
      	params.workdir = "/beegfs/rna-hta/$USER/work"
  	    params.permanentCacheDir = "/beegfs/rna-hta/nextflow-rnaseq-autodownload/"
        conda.cacheDir = "/beegfs/rna-hta/$USER/nextflow-conda-cache"
        process {
            clusterOptions = '--partition=s_standard,s_fat,b_standard,b_fat'
            withLabel: smallTask { executor = 'local' }
        }
        includeConfig 'configs/slurm.config'
        includeConfig 'configs/conda.config' }
}
